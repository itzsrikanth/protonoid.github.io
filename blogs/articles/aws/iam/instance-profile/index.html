<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>IAM instance profile</title><meta name="description" content="Role of Instance profile in EC2 application access management and IAM Role containment"/><meta charset="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="next-head-count" content="6"/><link rel="preload" href="/_next/static/css/commons.be16d001.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/commons.be16d001.chunk.css"/><link rel="preload" href="/_next/static/ZMhGs822iLmlZCYEc_a9c/pages/articles.js" as="script"/><link rel="preload" href="/_next/static/ZMhGs822iLmlZCYEc_a9c/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.b6dc333151af4a74b05a.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-5b3d9dcbbf35909ee5a1.js" as="script"/></head><body><div id="__next"><nav class="d-flex align-items-center"><div class="container"><ul><li><a href="/blogs">Blogs</a></li></ul></div></nav><div class="container"><div><h1 id="introduction">Introduction</h1>
<ul>
<li>Using the console, when we create IAM Role, an instance profile is automatically created with same name as that of the role.</li>
<li>Relation from instance profile to IAM role is one to one but the reverse is one to many i.e. only one role can be added to an instance profile but same role can be part of many instance profiles.</li>
<li>From instance metadata, security credentials can be retrieved from the path <code>iam/security-credentials/&lt;role_name&gt;</code>. So the application will get access to all the resources and actions allowed for the role.</li>
<li>According to AWS Documentation, instance profile is a container for IAM role to pass role information from AWS to EC2 after boot because the applications within EC2 machines run within a VM abstraction / enclosure.</li>
</ul>
<h2 id="temporary-security-credentials">Temporary Security Credentials</h2>
<p>The temporary credentials can be obtained:</p>
<ul>
<li>for AWS CLI, we can use roles for EC2</li>
<li>or for SDKs, use AWS STS API - <a href="https://sts.amazonaws.com">AWS Identity &amp; Access Management - Amazon Web Services</a></li>
</ul>
<h3 id="curl">Curl</h3>
<p>Using curl, if we hit <code>http://169.254.169.254/latest/meta-data/iam/security-credentials/&lt;role_name&gt;</code>, we will obtain a JSON with following structure:</p>
<pre><code class="language-json">{
  &quot;Code&quot; : &quot;Success&quot;,
  &quot;LastUpdated&quot; : &quot;2020-01-02T10:31:04Z&quot;,
  &quot;Type&quot; : &quot;AWS-HMAC&quot;,
  &quot;AccessKeyId&quot; : &quot;XXXXXXXXXXXXXXXXXX&quot;,
  &quot;SecretAccessKey&quot; : &quot;xxxxxxxxxxxxxxxxxxxxxxxxx&quot;,
  &quot;Token&quot; : &quot;xxxxxxxxxxxxxxxxxxxxxxxxxx==&quot;,
  &quot;Expiration&quot; : &quot;2020-01-02T16:35:14Z&quot;
}</code></pre>
<p>using the above values we can set the following global variables:</p>
<pre><code class="language-bash">export AWS_ACCESS_KEY_ID=&quot;XXXXXXXXXXXXXXXXXX&quot;
export AWS_SECRET_ACCESS_KEY=&quot;xxxxxxxxxxxxxxxxxxxxxxxxx&quot;
export AWS_SESSION_TOKEN=&quot;xxxxxxxxxxxxxxxxxxxxxxxxxx==&quot;</code></pre>
<p>Now, we are ready use the AWS CLI or SDK.</p>
</div></div></div><script id="__NEXT_DATA__" type="application/json">{"dataManager":"[]","props":{"pageProps":{}},"page":"/articles","query":{"attributes":{"title":"IAM instance profile","description":"Role of Instance profile in EC2 application access management and IAM Role containment"},"body":"\u003ch1 id=\"introduction\"\u003eIntroduction\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eUsing the console, when we create IAM Role, an instance profile is automatically created with same name as that of the role.\u003c/li\u003e\n\u003cli\u003eRelation from instance profile to IAM role is one to one but the reverse is one to many i.e. only one role can be added to an instance profile but same role can be part of many instance profiles.\u003c/li\u003e\n\u003cli\u003eFrom instance metadata, security credentials can be retrieved from the path \u003ccode\u003eiam/security-credentials/\u0026lt;role_name\u0026gt;\u003c/code\u003e. So the application will get access to all the resources and actions allowed for the role.\u003c/li\u003e\n\u003cli\u003eAccording to AWS Documentation, instance profile is a container for IAM role to pass role information from AWS to EC2 after boot because the applications within EC2 machines run within a VM abstraction / enclosure.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"temporary-security-credentials\"\u003eTemporary Security Credentials\u003c/h2\u003e\n\u003cp\u003eThe temporary credentials can be obtained:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efor AWS CLI, we can use roles for EC2\u003c/li\u003e\n\u003cli\u003eor for SDKs, use AWS STS API - \u003ca href=\"https://sts.amazonaws.com\"\u003eAWS Identity \u0026amp; Access Management - Amazon Web Services\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"curl\"\u003eCurl\u003c/h3\u003e\n\u003cp\u003eUsing curl, if we hit \u003ccode\u003ehttp://169.254.169.254/latest/meta-data/iam/security-credentials/\u0026lt;role_name\u0026gt;\u003c/code\u003e, we will obtain a JSON with following structure:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e{\n  \u0026quot;Code\u0026quot; : \u0026quot;Success\u0026quot;,\n  \u0026quot;LastUpdated\u0026quot; : \u0026quot;2020-01-02T10:31:04Z\u0026quot;,\n  \u0026quot;Type\u0026quot; : \u0026quot;AWS-HMAC\u0026quot;,\n  \u0026quot;AccessKeyId\u0026quot; : \u0026quot;XXXXXXXXXXXXXXXXXX\u0026quot;,\n  \u0026quot;SecretAccessKey\u0026quot; : \u0026quot;xxxxxxxxxxxxxxxxxxxxxxxxx\u0026quot;,\n  \u0026quot;Token\u0026quot; : \u0026quot;xxxxxxxxxxxxxxxxxxxxxxxxxx==\u0026quot;,\n  \u0026quot;Expiration\u0026quot; : \u0026quot;2020-01-02T16:35:14Z\u0026quot;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eusing the above values we can set the following global variables:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003eexport AWS_ACCESS_KEY_ID=\u0026quot;XXXXXXXXXXXXXXXXXX\u0026quot;\nexport AWS_SECRET_ACCESS_KEY=\u0026quot;xxxxxxxxxxxxxxxxxxxxxxxxx\u0026quot;\nexport AWS_SESSION_TOKEN=\u0026quot;xxxxxxxxxxxxxxxxxxxxxxxxxx==\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, we are ready use the AWS CLI or SDK.\u003c/p\u003e\n","frontmatter":"title: IAM instance profile\ndescription: Role of Instance profile in EC2 application access management and IAM Role containment"},"buildId":"ZMhGs822iLmlZCYEc_a9c","nextExport":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-5fa5b8189f4681d353e9.js"></script><script async="" data-next-page="/articles" src="/_next/static/ZMhGs822iLmlZCYEc_a9c/pages/articles.js"></script><script async="" data-next-page="/_app" src="/_next/static/ZMhGs822iLmlZCYEc_a9c/pages/_app.js"></script><script src="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" async=""></script><script src="/_next/static/chunks/commons.b6dc333151af4a74b05a.js" async=""></script><script src="/_next/static/runtime/main-5b3d9dcbbf35909ee5a1.js" async=""></script></body></html>