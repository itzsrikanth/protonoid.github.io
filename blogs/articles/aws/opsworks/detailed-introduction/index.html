<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta charSet="utf-8"/><title>Opsworks detailed introduction - AWS</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/WQqsk4bV7Bjgque8IYGjU/pages/articles.js" as="script"/><link rel="preload" href="/_next/static/WQqsk4bV7Bjgque8IYGjU/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-4b444dab214c6491079c.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5641bae6dcdb46b9e30e.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.67314864e5ee77300274.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-c2a874049c0d0e609626.js" as="script"/><link rel="stylesheet" href="/_next/static/css/styles.5325d736.chunk.css"/></head><body><div id="__next"><div class="container"><h1 id="aws-opsworks---detailed-introduction">AWS Opsworks - Detailed Introduction</h1>
<h2 id="opsworks-inner-workings">Opsworks inner workings</h2>
<ul>
<li>Ruby interpreter is located at <code>/opt/aws/opsworks/local/bin/ruby</code>
Other executables are present at <code>/opt/aws/opsworks/current</code> like <code>opsworks-agent</code>, <code>opsworks-agent-cli</code> etc</li>
<li>When setup is run again <code>aws_opsworks_users::default</code> recipe is run, which includes the following actions:<ul>
<li>kill all processes of users</li>
<li>remove user (-r) options, which clears its home directory</li>
</ul>
</li>
<li>When creating <code>user</code> using <code>chef</code>, following things we need to be careful about<ul>
<li>The application that we deploy as a user should be in directory other than its home directory because if some process executes <code>userdel -r &lt;username&gt;</code> all our files will be lost, especially persistent storage</li>
<li>We need to be careful about <code>manage_home</code> being set to <code>true</code> because of following line of command:
<code>/opt/aws/opsworks/current/vendor/bundle/ruby/&lt;ruby_version&gt;/gems/chef-&lt;chef_version&gt;/spec/support/shared/unit/provider/useradd_based_user_provider.rb:    it &quot;should run userdel with the new resources user name and -r if manage_home is true&quot; do</code></li>
</ul>
</li>
<li>Logs for each run is stored in <code>/var/chef/runs</code>,
available at <code>https://console.aws.amazon.com/opsworks/home?region=&lt;region_name&gt;#/stack/&lt;stack_id&gt;/instances/&lt;instance_id&gt;/log/&lt;run_id&gt;</code>
(Here, run id is obtained from <code>/var/chef/runs</code>)</li>
</ul>
</div></div><script id="__NEXT_DATA__" type="application/json">{"dataManager":"[]","props":{"pageProps":{}},"page":"/articles","query":{"attributes":{"title":"Opsworks detailed introduction - AWS"},"body":"\u003ch1 id=\"aws-opsworks---detailed-introduction\"\u003eAWS Opsworks - Detailed Introduction\u003c/h1\u003e\n\u003ch2 id=\"opsworks-inner-workings\"\u003eOpsworks inner workings\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eRuby interpreter is located at \u003ccode\u003e/opt/aws/opsworks/local/bin/ruby\u003c/code\u003e\nOther executables are present at \u003ccode\u003e/opt/aws/opsworks/current\u003c/code\u003e like \u003ccode\u003eopsworks-agent\u003c/code\u003e, \u003ccode\u003eopsworks-agent-cli\u003c/code\u003e etc\u003c/li\u003e\n\u003cli\u003eWhen setup is run again \u003ccode\u003eaws_opsworks_users::default\u003c/code\u003e recipe is run, which includes the following actions:\u003cul\u003e\n\u003cli\u003ekill all processes of users\u003c/li\u003e\n\u003cli\u003eremove user (-r) options, which clears its home directory\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWhen creating \u003ccode\u003euser\u003c/code\u003e using \u003ccode\u003echef\u003c/code\u003e, following things we need to be careful about\u003cul\u003e\n\u003cli\u003eThe application that we deploy as a user should be in directory other than its home directory because if some process executes \u003ccode\u003euserdel -r \u0026lt;username\u0026gt;\u003c/code\u003e all our files will be lost, especially persistent storage\u003c/li\u003e\n\u003cli\u003eWe need to be careful about \u003ccode\u003emanage_home\u003c/code\u003e being set to \u003ccode\u003etrue\u003c/code\u003e because of following line of command:\n\u003ccode\u003e/opt/aws/opsworks/current/vendor/bundle/ruby/\u0026lt;ruby_version\u0026gt;/gems/chef-\u0026lt;chef_version\u0026gt;/spec/support/shared/unit/provider/useradd_based_user_provider.rb:    it \u0026quot;should run userdel with the new resources user name and -r if manage_home is true\u0026quot; do\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eLogs for each run is stored in \u003ccode\u003e/var/chef/runs\u003c/code\u003e,\navailable at \u003ccode\u003ehttps://console.aws.amazon.com/opsworks/home?region=\u0026lt;region_name\u0026gt;#/stack/\u0026lt;stack_id\u0026gt;/instances/\u0026lt;instance_id\u0026gt;/log/\u0026lt;run_id\u0026gt;\u003c/code\u003e\n(Here, run id is obtained from \u003ccode\u003e/var/chef/runs\u003c/code\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n","frontmatter":"title: Opsworks detailed introduction - AWS"},"buildId":"WQqsk4bV7Bjgque8IYGjU","nextExport":true}</script><script async="" data-next-page="/articles" src="/_next/static/WQqsk4bV7Bjgque8IYGjU/pages/articles.js"></script><script async="" data-next-page="/_app" src="/_next/static/WQqsk4bV7Bjgque8IYGjU/pages/_app.js"></script><script src="/_next/static/runtime/webpack-4b444dab214c6491079c.js" async=""></script><script src="/_next/static/chunks/commons.5641bae6dcdb46b9e30e.js" async=""></script><script src="/_next/static/chunks/styles.67314864e5ee77300274.js" async=""></script><script src="/_next/static/runtime/main-c2a874049c0d0e609626.js" async=""></script></body></html>